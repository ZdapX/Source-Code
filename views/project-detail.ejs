<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CORE_DATA // <%= project.name %></title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="app-container">
        <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 4rem;">
            <div>
                <span class="badge" style="margin-bottom: 1rem; display: inline-block;"><%= project.language %></span>
                <h1><%= project.name %></h1>
            </div>
            <div class="stat-group">
                <span class="stat-label">Source Owner</span>
                <span class="stat-value"><%= project.uploadedBy %></span>
            </div>
        </div>

        <% if(project.preview) { %>
            <div style="border-radius: 3rem; overflow: hidden; border: 1px solid var(--zinc-800); margin-bottom: 4rem;">
                <img src="<%= project.preview %>" style="width: 100%; display: block;">
            </div>
        <% } %>

        <div style="display: grid; grid-template-columns: 1fr 350px; gap: 4rem;">
            <div class="content">
                <h2 class="mono" style="color: var(--accent); margin-bottom: 1.5rem;">[ DOCUMENTATION ]</h2>
                <p style="color: var(--zinc-400); font-size: 1.2rem; margin-bottom: 3rem;">
                    <%= project.note || 'No encryption documentation provided.' %>
                </p>

                <% if(project.type === 'code') { %>
                    <div style="background: #050505; border: 1px solid var(--zinc-800); border-radius: 2rem; padding: 2.5rem; font-family: var(--font-mono);">
                        <pre style="color: #eee; overflow-x: auto;"><code><%= project.content %></code></pre>
                    </div>
                <% } %>
            </div>

            <div class="sidebar">
                <div style="background: var(--zinc-900); border-radius: 3rem; padding: 3rem; border: 1px solid var(--zinc-800); position: sticky; top: 2rem;">
                    <div class="stat-group" style="align-items: flex-start; margin-bottom: 2rem;">
                        <span class="stat-label">Repository Likes</span>
                        <span class="stat-value" id="l-count" style="font-size: 2rem;"><%= project.likes %></span>
                    </div>
                    
                    <button class="btn-glow" style="width: 100%; margin-bottom: 1rem;" onclick="location.href='/project/<%= project._id %>/download-hit'">INITIALIZE_DOWNLOAD</button>
                    <button class="cyber-input" style="text-align: center; cursor: pointer;" onclick="handleLike()">RESONATE_LIKE</button>
                </div>
            </div>
        </div>
    </div>

    <nav class="nav-floating">
        <a href="/" class="nav-link">TERMINATE_VIEW</a>
    </nav>

    <script>
        async function handleLike() {
            const res = await fetch('/project/<%= project._id %>/like', { method: 'POST' });
            const data = await res.json();
            if(data.success) document.getElementById('l-count').innerText = data.totalLikes;
        }
    </script>
</body>
</html>
