<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= project.name %> // Elite Repository</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="app-container">
        <header style="margin-bottom: 4rem;">
            <a href="/" class="nav-link" style="margin-bottom: 2rem; display: block;">[ ‚Üê BACK_TO_DATABASE ]</a>
            <span class="badge" style="margin-bottom: 1rem;"><%= project.language %> // <%= project.type.toUpperCase() %></span>
            <h1><%= project.name %></h1>
        </header>

        <div style="display: grid; grid-template-columns: 1fr 350px; gap: 4rem;">
            <div class="main-content">
                <% if(project.preview) { %>
                    <div style="border-radius: 3rem; overflow: hidden; border: 1px solid var(--zinc-800); margin-bottom: 3rem;">
                        <img src="<%= project.preview %>" style="width: 100%; display: block;">
                    </div>
                <% } %>
                
                <div style="background: var(--zinc-900); padding: 3rem; border-radius: 3rem; border: 1px solid var(--zinc-800); margin-bottom: 3rem;">
                    <p class="mono" style="color: var(--accent); margin-bottom: 1rem;">[ DOCUMENTATION ]</p>
                    <p><%= project.note || "No documentation." %></p>
                </div>

                <% if(project.type === 'code') { %>
                    <div style="background: #050505; border: 1px solid var(--zinc-800); border-radius: 2rem; padding: 2.5rem; font-family: var(--font-mono); overflow-x: auto;">
                        <pre><code id="pCode"><%= project.content %></code></pre>
                    </div>
                <% } %>
            </div>

            <div class="sidebar">
                <div style="background: var(--zinc-900); border: 1px solid var(--zinc-800); border-radius: 3.5rem; padding: 3rem; position: sticky; top: 2rem;">
                    <div style="margin-bottom: 2rem;">
                        <p class="stat-label">Likes</p>
                        <p class="stat-value" id="likeCount" style="font-size: 2.5rem;"><%= project.likes %></p>
                    </div>
                    
                    <% if(project.type === 'file') { %>
                        <a href="/project/<%= project._id %>/download-hit" class="btn-glow" style="width: 100%; display: block; text-decoration: none;">DOWNLOAD_ZIP</a>
                    <% } else { %>
                        <button class="btn-glow" style="width: 100%;" onclick="copyCode()">COPY_SOURCE</button>
                    <% } %>
                    
                    <button class="cyber-input" style="margin-top: 1rem; text-align: center; cursor: pointer;" onclick="like()">RESONATE_LIKE</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function like() {
            const res = await fetch('/project/<%= project._id %>/like', {method:'POST'});
            const data = await res.json();
            if(data.success) document.getElementById('likeCount').innerText = data.totalLikes;
        }
        function copyCode() {
            const c = document.getElementById('pCode').innerText;
            navigator.clipboard.writeText(c);
            alert("Copied to buffer!");
        }
    </script>
</body>
</html>
